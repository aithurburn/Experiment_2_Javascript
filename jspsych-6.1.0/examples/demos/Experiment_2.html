<!DOCTYPE html>
<html>
    <head>
        <script src="../../jspsych.js"></script>
        <script src="../../plugins/jspsych-html-keyboard-response.js"></script>
        <script src="../../plugins/jspsych-survey-text.js"></script>
        <script src="../../plugins/jspsych-survey-multi-choice.js"></script>
        <script src="../../configuration/text_variables.js"></script>
        <link rel="stylesheet" href="../../css/jspsych.css">
        <style>
        </style>
    </head>
    <body>
    </body>
    <script>
    
      var timeline = [];
      var welcome = {
        type: "html-keyboard-response",
        stimulus: "Welcome to the experiment. Press any key to begin."
      };


      var instructions = {
        type: "html-keyboard-response",
        stimulus: "<p>This experiment is being conducted in PsychoPy. Your anonymous data will be saved on this computer and then stored securely on University of Edinburgh server. \nThe collection of personal data will be kept to a minimum to ensure anonymity is maintained.\nPlease confirm that you have read and understood the participant information sheet and consent to participant in this experiment by pressing the “Y” key." +
          "</div>" +
          "<p>Press any key to begin.</p>",
        post_trial_gap: 500,
      };

      var demographicBlock = {
        timeline: [{
            type: 'survey-text',
            questions: [{
              prompt: ageStimulus,
              value: ""
            }, ],
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: genderStimulus,
            choices: ['1', '2', '3', '4', '5', '6'],
            prompt: genderOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: ethnicityStimulus,
            choices: ['1', '2', '3', '4', '5', '6', '7', '8'],
            prompt: ethnicityOptions,
            post_trial_gap: 500,
          }
        ]
      }
      var spiteBlock = {
        timeline: [{
            type: 'html-keyboard-response',
            stimulus: spiteOne,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteTwo,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteThree,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteFour,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteFive,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteSix,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteSeven,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteEight,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteNine,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteTen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteEleven,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteTwelve,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteThirteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteFourteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteFifteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          },
          {
            type: 'html-keyboard-response',
            stimulus: spiteSixteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: spiteOptions,
            post_trial_gap: 500,
          }
        ]
      }
      var sessBlock = {
        timeline: [{
            type: "html-keyboard-response",
            stimulus: sessOne,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessTwo,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessThree,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessFour,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessFive,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessSix,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessSeven,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessEight,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessNine,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessTen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessEleven,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessTwelve,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessThirteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sessFourteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualFifteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualSixteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualSeventeen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualEighteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualNineteen,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualTwenty,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualTwentyOne,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualTwentyTwo,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          },
          {
            type: "html-keyboard-response",
            stimulus: sexualTwentyThree,
            choices: ['1', '2', '3', '4', '5'],
            prompt: sessOptions,
            post_trial_gap: 500,
          }
        ]
      }
      

      var debriefBlock = {
        type: "html-keyboard-response",
        stimulus: function () {

          var trials = jsPsych.data.get().filter({
            test_part: 'test'
          });
          var correct_trials = trials.filter({
            correct: true
          });
          var accuracy = Math.round(correct_trials.count() / trials.count() * 100);
          var rt = Math.round(correct_trials.select('rt').mean());

          return "<p>You responded correctly on " + accuracy + "% of the trials.</p>" +
            "<p>Your average response time was " + rt + "ms.</p>" +
            "<p>Press any key to complete the experiment. Thank you!</p>";

        }
      };
      var test_array = [sessBlock, spiteBlock];
      var test_procedure = jsPsych.randomization.shuffle(test_array);
      
      timeline.push(welcome);
      timeline.push(instructions);
      timeline.push(demographicBlock);
      timeline = timeline.concat(test_procedure);
      timeline.push(debriefBlock);
      jsPsych.init({
        timeline: timeline,
        on_finish: function () {
          jsPsych.data.displayData();
        }
      });
  </script>
</html>
